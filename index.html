<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="title">CaÃ§a-NÃ­quel Virtual</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        :root { --primary-color: #6a1b9a; --secondary-color: #ffc107; --dark-bg: #121212; --light-text: #fff; }
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--dark-bg); color: var(--light-text); margin: 0; padding: 20px 10px; display: flex; flex-direction: column; align-items: center; }
        .header { text-align: center; margin-bottom: 20px; }
        .subtitle {
            color: var(--secondary-color);
            font-size: 1.2em;
            font-weight: bold;
            /* text-transform: uppercase; foi removido para controle manual */
            margin-top: -10px;
        }
        .subtitle strong {
            color: inherit;
        }
        .balance { background-color: #333; padding: 10px 20px; border-radius: 50px; font-size: 1.2em; font-weight: bold; }
        .balance span { color: var(--secondary-color); }
        .slot-machine { background: linear-gradient(145deg, #444, #222); border: 5px solid #a9a9a9; border-radius: 20px; padding: 20px; display: flex; gap: 15px; justify-content: center; box-shadow: 0 10px 20px rgba(0,0,0,0.5), inset 0 0 15px rgba(0,0,0,0.7); max-width: 100%; }
        .reel { width: 100px; height: 100px; background-color: #fff; border: 3px solid #333; border-radius: 10px; overflow: hidden; position: relative; }
        .reel-symbols { position: absolute; top: 0; left: 0; width: 100%; }
        .reel-symbols span { display: block; font-size: 70px; height: 100px; line-height: 100px; text-align: center; }
        .controls { margin-top: 30px; display: flex; flex-direction: column; align-items: center; gap: 20px; }
        .spin-button { padding: 15px 40px; font-size: 1.5em; font-weight: bold; color: #333; background-color: var(--secondary-color); border: none; border-radius: 10px; cursor: pointer; transition: transform 0.1s; order: 1; }
        .spin-button:active:not(:disabled) { transform: scale(0.95); }
        .spin-button:disabled { background-color: #555; cursor: not-allowed; }
        .buy-chips-button { padding: 10px 20px; font-size: 1em; background-color: var(--primary-color); border-radius: 5px; border: none; color: white; cursor: pointer; transform: scale(1.5); order: 2; }
        .pulsating-button { animation: pulse-button 2s 5; }
        @keyframes pulse-button { 0% { box-shadow: 0 0 0 0 rgba(171, 71, 188, 0.7); } 70% { box-shadow: 0 0 0 12px rgba(171, 71, 188, 0); } 100% { box-shadow: 0 0 0 0 rgba(171, 71, 188, 0); } }
        #result-text { margin-top: 20px; font-size: 1.2em; font-weight: bold; height: 30px; transition: color 0.3s; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background-color: #333; padding: 20px; border-radius: 10px; max-width: 400px; width: 90%; text-align: center; }
        .close-button { float: right; font-size: 28px; cursor: pointer; }
        .chip-options { display: flex; flex-direction: column; gap: 15px; margin: 20px 0; }
        .chip-option { background-color: var(--primary-color); padding: 15px; border-radius: 10px; cursor: pointer; font-size: 1.1em; transition: background-color 0.2s; }
        #pix-payment-view p, #email-prompt-view p { color: #ccc; }
        #email-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #777; background-color: #444; color: white; text-align: center; margin-bottom: 15px; }
        #generate-pix-btn { width: 100%; padding: 12px; font-size: 1em; background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; }
        #qr-code-image { border: 4px solid white; border-radius: 8px; max-width: 100%; height: auto; }
        #start-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--dark-bg); z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        #start-overlay h1 { font-size: 2em; color: var(--secondary-color); }
        #start-overlay p { font-size: 1.2em; }
        /* Estilos para o formulÃ¡rio do Stripe */
        #payment-element { margin-bottom: 20px; }
        .submit-btn { width: 100%; padding: 12px; font-size: 1em; background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; }
        
        /* CSS da AnimaÃ§Ã£o de Piscar */
        .blinking-text {
            animation: blink-animation 4.00s infinite;
        }

        @keyframes blink-animation {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="start-overlay">
        <h1 data-i18n-key="welcome">Bem-Vindo!</h1>
        <p data-i18n-key="clickToStart">Clique em qualquer lugar para comeÃ§ar</p>
    </div>

    <div class="header">
        <h1 data-i18n-key="mainTitle">ğŸ° CaÃ§a-NÃ­quel PIX ğŸ°</h1>
        <p class="subtitle" data-i18n-key="subtitle"></p>
        <div class="balance"><span data-i18n-key="balance">SALDO</span>: <span id="chip-balance">--</span> <span data-i18n-key="chips">FICHAS</span></div>
    </div>

    <div class="slot-machine">
        <div class="reel" id="reel1"><div class="reel-symbols"><span>ğŸ’</span></div></div>
        <div class="reel" id="reel2"><div class="reel-symbols"><span>ğŸ‹</span></div></div>
        <div class="reel" id="reel3"><div class="reel-symbols"><span>ğŸ””</span></div></div>
    </div>

    <div class="controls">
        <button class="spin-button" id="spin-btn" data-i18n-key="spin">GIRAR</button>
        <button class="buy-chips-button" id="buy-chips-btn">
            <strong data-i18n-key="buyChips">Comprar Fichas</strong>
        </button>
    </div>
    
    <div id="result-text" data-i18n-key="goodLuck">Boa Sorte!</div>

    <div class="modal-overlay" id="buy-chips-modal"></div>

    <audio id="spin-sound" src="/sounds/spin.mp3" preload="auto"></audio>
    <audio id="win-sound" src="/sounds/win.mp3" preload="auto"></audio>
    <audio id="buy-chips-sound" src="/sounds/buy-chips.mp3" preload="auto"></audio>
    <audio id="background-music" src="/sounds/background-music.mp3" preload="auto" loop></audio>

    <script>
        // --------------- CONFIGURAÃ‡Ã•ES GLOBAIS ---------------
        const stripe = Stripe('pk_live_51Rk5NYJcbIloH2KIEFIvqtbOmfnAYsfOlq3b0rys3bWithTr07dy9A0dlKCnH1nQgn5Qje3cq5UAlfCGoedL0ElF00qsAZpigh'); // <-- IMPORTANTE: SUBSTITUA PELA SUA CHAVE
        const spinBtn = document.getElementById('spin-btn');
        const chipBalanceSpan = document.getElementById('chip-balance');
        const resultText = document.getElementById('result-text');
        const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
        const symbols = ['ğŸ’', 'ğŸ‹', 'ğŸ””', 'ğŸ’', '7ï¸âƒ£'];
        const spinSound = document.getElementById('spin-sound');
        const winSound = document.getElementById('win-sound');
        const buyChipsSound = document.getElementById('buy-chips-sound');
        const backgroundMusic = document.getElementById('background-music');

        let isMusicPlaying = false;
        let localeConfig; 
        let currentPaymentId, paymentCheckInterval, selectedPackageId, selectedAmount;

        // --------------- DICIONÃRIO DE TRADUÃ‡Ã•ES E CONFIGURAÃ‡Ã•ES ---------------
        const locales = {
            'pt-br': {
                paymentGateway: 'MercadoPago',
                lang: 'pt-BR',
                currency: 'R$',
                packages: [
                    { id: 'pack_10', chips: 10, price: 5.00, display: '10 Fichas - R$ 5,00' },
                    { id: 'pack_25', chips: 25, price: 10.00, display: '25 Fichas - R$ 10,00' },
                    { id: 'pack_250', chips: 250, price: 50.00, display: '250 Fichas - R$ 50,00' },
                ],
                translations: {
                    mainTitle: "ğŸ° CaÃ§a-NÃ­quel PIX ğŸ°",
                    title: "CaÃ§a-NÃ­quel Virtual", welcome: "Bem-Vindo!", clickToStart: "Clique em qualquer lugar para comeÃ§ar",
                    subtitle: "Ganhe <strong>100.000 REAIS</strong> se acertar as 3 figuras!!!",
                    balance: "SALDO", chips: "FICHAS", spin: "GIRAR",
                    buyChips: "Comprar Fichas", goodLuck: "Boa Sorte!", insufficientChips: "Fichas insuficientes!",
                    spinning: "Girando...", tryAgain: "Tente Novamente!", youWon: "VocÃª ganhou {amount} fichas!",
                    buyChipsTitle: "Comprar Fichas", almostThere: "Quase lÃ¡!", emailInfo: "Escreva o seu e-mail abaixo, se voce ganhar entraremos em contato atraves do seu e-mail:",
                    payWithPix: "Pague com PIX", scanQrCode: "Escaneie o QR Code abaixo:", orUseCopyPaste: "Ou use o PIX Copia e Cola:",
                    waitingPayment: "Aguardando pagamento...", copy: "Copiar", copied: "Copiado!", paymentApproved: "Pagamento aprovado! Fichas creditadas.",
                    generatingPix: "Gerando PIX...", enterValidEmail: "Por favor, insira um e-mail vÃ¡lido.",
                    payWithCard: "Pagar com CartÃ£o", cardInfo: "Insira os dados do seu cartÃ£o abaixo.", pay: "Pagar {amount}",
                    processing: "Processando...", paymentSuccessful: "Pagamento realizado com sucesso!",
                    error_generic: "Ocorreu um erro", error_api_keys: "Por favor, verifique a configuraÃ§Ã£o do servidor."
                }
            },
            'en': {
                paymentGateway: 'Stripe', lang: 'en-US', currency: '$',
                packages: [ 
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Chips - $3.00' }, 
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Chips - $5.00' }, 
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Chips - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Virtual Slot Machine ğŸ°", title: "Virtual Slot Machine", welcome: "Welcome!", clickToStart: "Click anywhere to start", subtitle: "Win <strong>20,000 DOLLARS</strong> if you match all 3 symbols!!!", balance: "BALANCE", chips: "CHIPS", spin: "SPIN", buyChips: "Buy Chips", goodLuck: "Good Luck!", insufficientChips: "Not enough chips!", spinning: "Spinning...", tryAgain: "Try Again!", youWon: "You won {amount} chips!", buyChipsTitle: "Buy Chips", almostThere: "Almost there!", emailInfo: "Enter your email below. If you win, we will contact you at this email address:", payWithCard: "Pay with Card", cardInfo: "Enter your card details below.", pay: "Pay {amount}", processing: "Processing...", paymentSuccessful: "Payment successful!", enterValidEmail: "Please enter a valid email.", error_generic: "An error occurred", error_api_keys: "Please check the server configuration." }
            },
            'es': {
                paymentGateway: 'Stripe', lang: 'es-ES', currency: '$',
                packages: [ 
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Fichas - $3.00' }, 
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Fichas - $5.00' }, 
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Fichas - $10.00' }, 
                ],
                translations: { mainTitle: "ğŸ° Tragamonedas Virtual ğŸ°", title: "Tragamonedas Virtual", welcome: "Â¡Bienvenido!", clickToStart: "Haga clic en cualquier lugar para comenzar", subtitle: "Â¡Gana <strong>20.000 DÃ“LARES</strong> si aciertas los 3 sÃ­mbolos!", balance: "SALDO", chips: "FICHAS", spin: "GIRAR", buyChips: "Comprar Fichas", goodLuck: "Â¡Buena Suerte!", insufficientChips: "Â¡No hay suficientes fichas!", spinning: "Girando...", tryAgain: "Â¡IntÃ©ntalo de Nuevo!", youWon: "Â¡Has ganado {amount} fichas!", buyChipsTitle: "Comprar Fichas", almostThere: "Â¡Casi listo!", emailInfo: "Escriba su correo electrÃ³nico a continuaciÃ³n. Si gana, nos pondremos en contacto con usted a travÃ©s de su correo electrÃ³nico:", payWithCard: "Pagar con Tarjeta", cardInfo: "Introduce los datos de tu tarjeta a continuaciÃ³n.", pay: "Pagar {amount}", processing: "Procesando...", paymentSuccessful: "Â¡Pago exitoso!", enterValidEmail: "Por favor, introduce un email vÃ¡lido.", error_generic: "OcurriÃ³ un error", error_api_keys: "Por favor, compruebe la configuraciÃ³n del servidor." }
            },
            'it': {
                paymentGateway: 'Stripe', lang: 'it-IT', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Gettoni - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Gettoni - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Gettoni - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Slot Machine Virtuale ğŸ°", title: "Slot Machine Virtuale", welcome: "Benvenuto!", clickToStart: "Clicca ovunque per iniziare", subtitle: "Vinci <strong>20.000 DOLLARI</strong> se allinei 3 simboli!!!", balance: "SALDO", chips: "GETTONI", spin: "GIRA", buyChips: "Compra Gettoni", goodLuck: "Buona Fortuna!", insufficientChips: "Gettoni insufficienti!", spinning: "Girando...", tryAgain: "Riprova!", youWon: "Hai vinto {amount} gettoni!", buyChipsTitle: "Compra Gettoni", almostThere: "Quasi fatto!", emailInfo: "Inserisci la tua email qui sotto. Se vinci, ti contatteremo tramite il tuo indirizzo email:", payWithCard: "Paga con Carta", cardInfo: "Inserisci i dati della tua carta qui sotto.", pay: "Paga {amount}", processing: "In elaborazione...", paymentSuccessful: "Pagamento riuscito!", enterValidEmail: "Per favore, inserisci un'email valida.", error_generic: "Si Ã¨ verificato un errore", error_api_keys: "Per favore, controlla la configurazione del server." }
            },
            'fr': {
                paymentGateway: 'Stripe', lang: 'fr-FR', currency: '$',
                packages: [ 
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Jetons - $3.00' }, 
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Jetons - $5.00' }, 
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Jetons - $10.00' }, 
                ],
                translations: { mainTitle: "ğŸ° Machine Ã  Sous Virtuelle ğŸ°", title: "Machine Ã  Sous Virtuelle", welcome: "Bienvenue !", clickToStart: "Cliquez n'importe oÃ¹ pour commencer", subtitle: "Gagnez <strong>20.000 DOLLARS</strong> si vous obtenez les 3 symboles !!!", balance: "SOLDE", chips: "JETONS", spin: "TOURNER", buyChips: "Acheter des Jetons", goodLuck: "Bonne Chance !", insufficientChips: "Jetons insuffisants !", spinning: "Rotation...", tryAgain: "RÃ©essayez !", youWon: "Vous avez gagnÃ© {amount} jetons !", buyChipsTitle: "Acheter des Jetons", almostThere: "Presque lÃ  !", emailInfo: "Veuillez saisir votre e-mail ci-dessous. Si vous gagnez, nous vous contacterons via votre adresse e-mail :", payWithCard: "Payer par Carte", cardInfo: "Entrez les dÃ©tails de votre carte ci-dessous.", pay: "Payer {amount}", processing: "Traitement...", paymentSuccessful: "Paiement rÃ©ussi !", enterValidEmail: "Veuillez saisir un e-mail valide.", error_generic: "Une erreur est survenue", error_api_keys: "Veuillez vÃ©rifier la configuration du serveur." }
            },
            'de': {
                paymentGateway: 'Stripe', lang: 'de-DE', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Chips - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Chips - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Chips - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Virtueller Spielautomat ğŸ°", title: "Virtueller Spielautomat", welcome: "Willkommen!", clickToStart: "Klicken Sie irgendwo, um zu starten", subtitle: "Gewinnen Sie <strong>20.000 DOLLAR</strong>, wenn Sie 3 Symbole treffen!!!", balance: "GUTHABEN", chips: "CHIPS", spin: "DREHEN", buyChips: "Chips Kaufen", goodLuck: "Viel GlÃ¼ck!", insufficientChips: "Nicht genÃ¼gend Chips!", spinning: "Dreht...", tryAgain: "Versuchen Sie es erneut!", youWon: "Sie haben {amount} Chips gewonnen!", buyChipsTitle: "Chips Kaufen", almostThere: "Fast geschafft!", emailInfo: "Geben Sie unten Ihre E-Mail-Adresse ein. Wenn Sie gewinnen, werden wir Sie Ã¼ber Ihre E-Mail-Adresse kontaktieren:", payWithCard: "Mit Karte bezahlen", cardInfo: "Geben Sie unten Ihre Kartendaten ein.", pay: "Bezahlen {amount}", processing: "Verarbeite...", paymentSuccessful: "Zahlung erfolgreich!", enterValidEmail: "Bitte geben Sie eine gÃ¼ltige E-Mail ein.", error_generic: "Ein Fehler ist aufgetreten", error_api_keys: "Bitte Ã¼berprÃ¼fen Sie die Serverkonfiguration." }
            },
            'ru': {
                paymentGateway: 'Stripe', lang: 'ru-RU', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Ñ„Ğ¸ÑˆĞµĞº - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Ñ„Ğ¸ÑˆĞµĞº - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Ñ„Ğ¸ÑˆĞµĞº - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚ ğŸ°", title: "Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚", welcome: "Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ!", clickToStart: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ² Ğ»ÑĞ±Ğ¾Ğ¼ Ğ¼ĞµÑÑ‚Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ", subtitle: "Ğ’Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ¹Ñ‚Ğµ <strong>20.000 Ğ”ĞĞ›Ğ›ĞĞ ĞĞ’</strong>, ĞµÑĞ»Ğ¸ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ÑƒÑ‚ 3 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°!!!", balance: "Ğ‘ĞĞ›ĞĞĞ¡", chips: "Ğ¤Ğ˜Ğ¨ĞšĞ˜", spin: "Ğ’Ğ ĞĞ©ĞĞ¢Ğ¬", buyChips: "ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ñ„Ğ¸ÑˆĞºĞ¸", goodLuck: "Ğ£Ğ´Ğ°Ñ‡Ğ¸!", insufficientChips: "ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ñ„Ğ¸ÑˆĞµĞº!", spinning: "Ğ’Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ...", tryAgain: "ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°!", youWon: "Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ {amount} Ñ„Ğ¸ÑˆĞµĞº!", buyChipsTitle: "ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ñ„Ğ¸ÑˆĞºĞ¸", almostThere: "ĞŸĞ¾Ñ‡Ñ‚Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾!", emailInfo: "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ Ğ°Ğ´Ñ€ĞµÑ ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‡Ñ‚Ñ‹ Ğ½Ğ¸Ğ¶Ğµ. Ğ’ ÑĞ»ÑƒÑ‡Ğ°Ğµ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹ÑˆĞ° Ğ¼Ñ‹ ÑĞ²ÑĞ¶ĞµĞ¼ÑÑ Ñ Ğ²Ğ°Ğ¼Ğ¸ Ğ¿Ğ¾ ÑÑ‚Ğ¾Ğ¼Ñƒ Ğ°Ğ´Ñ€ĞµÑÑƒ:", payWithCard: "ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ğ¾Ğ¹", cardInfo: "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ²Ğ°ÑˆĞµĞ¹ ĞºĞ°Ñ€Ñ‚Ñ‹ Ğ½Ğ¸Ğ¶Ğµ.", pay: "ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚ÑŒ {amount}", processing: "ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°...", paymentSuccessful: "ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ğ²ĞµÑ€ÑˆĞµĞ½!", enterValidEmail: "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ´Ñ€ĞµÑ ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‡Ñ‚Ñ‹.", error_generic: "ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°", error_api_keys: "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ ÑĞµÑ€Ğ²ĞµÑ€Ğ°." }
            },
            'ja': {
                paymentGateway: 'Stripe', lang: 'ja-JP', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 ãƒãƒƒãƒ— - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 ãƒãƒƒãƒ— - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 ãƒãƒƒãƒ— - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° ãƒãƒ¼ãƒãƒ£ãƒ«ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³ ğŸ°", title: "ãƒãƒ¼ãƒãƒ£ãƒ«ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³", welcome: "ã‚ˆã†ã“ãï¼", clickToStart: "ã‚¯ãƒªãƒƒã‚¯ã—ã¦é–‹å§‹", subtitle: "3ã¤ã®ã‚·ãƒ³ãƒœãƒ«ãŒæƒã†ã¨<strong>20,000 DOLLARS</strong>ã‚’ç²å¾—ï¼", balance: "æ®‹é«˜", chips: "ãƒãƒƒãƒ—", spin: "ã‚¹ãƒ”ãƒ³", buyChips: "ãƒãƒƒãƒ—ã‚’è³¼å…¥", goodLuck: "å¹¸é‹ã‚’ï¼", insufficientChips: "ãƒãƒƒãƒ—ãŒä¸è¶³ã—ã¦ã„ã¾ã™ï¼", spinning: "ã‚¹ãƒ”ãƒ³ä¸­...", tryAgain: "ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ï¼", youWon: "{amount}ãƒãƒƒãƒ—ã‚’ç²å¾—ã—ã¾ã—ãŸï¼", buyChipsTitle: "ãƒãƒƒãƒ—ã‚’è³¼å…¥", almostThere: "ã‚‚ã†ã™ãã§ã™ï¼", emailInfo: "ä»¥ä¸‹ã«ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚å½“é¸ã—ãŸå ´åˆã¯ã€ã”è¨˜å…¥ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã”é€£çµ¡ã„ãŸã—ã¾ã™ï¼š", payWithCard: "ã‚«ãƒ¼ãƒ‰ã§æ”¯æ‰•ã†", cardInfo: "ä»¥ä¸‹ã«ã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", pay: "{amount}ã‚’æ”¯æ‰•ã†", processing: "å‡¦ç†ä¸­...", paymentSuccessful: "æ”¯æ‰•ã„ãŒæˆåŠŸã—ã¾ã—ãŸï¼", enterValidEmail: "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", error_generic: "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ", error_api_keys: "ã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚" }
            },
            'ko': {
                paymentGateway: 'Stripe', lang: 'ko-KR', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 ì¹© - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 ì¹© - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 ì¹© - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° ê°€ìƒ ìŠ¬ë¡¯ ë¨¸ì‹  ğŸ°", title: "ê°€ìƒ ìŠ¬ë¡¯ ë¨¸ì‹ ", welcome: "í™˜ì˜í•©ë‹ˆë‹¤!", clickToStart: "ì‹œì‘í•˜ë ¤ë©´ ì•„ë¬´ ê³³ì´ë‚˜ í´ë¦­í•˜ì„¸ìš”", subtitle: "3ê°œì˜ ì‹¬ë³¼ì´ ëª¨ë‘ ë§ìœ¼ë©´ <strong>20,000 DOLLARS</strong>ë¥¼ íšë“í•˜ì„¸ìš”!!!", balance: "ì”ì•¡", chips: "ì¹©", spin: "ìŠ¤í•€", buyChips: "ì¹© êµ¬ë§¤", goodLuck: "í–‰ìš´ì„ ë¹•ë‹ˆë‹¤!", insufficientChips: "ì¹©ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!", spinning: "íšŒì „ ì¤‘...", tryAgain: "ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”!", youWon: "{amount}ê°œì˜ ì¹©ì„ íšë“í–ˆìŠµë‹ˆë‹¤!", buyChipsTitle: "ì¹© êµ¬ë§¤", almostThere: "ê±°ì˜ ë‹¤ ì™”ìŠµë‹ˆë‹¤!", emailInfo: "ì•„ë˜ì— ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”. ìš°ìŠ¹ ì‹œ ì…ë ¥í•˜ì‹  ì´ë©”ì¼ë¡œ ì—°ë½ë“œë¦½ë‹ˆë‹¤:", payWithCard: "ì¹´ë“œë¡œ ê²°ì œ", cardInfo: "ì•„ë˜ì— ì¹´ë“œ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.", pay: "{amount} ê²°ì œ", processing: "ì²˜ë¦¬ ì¤‘...", paymentSuccessful: "ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!", enterValidEmail: "ìœ íš¨í•œ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.", error_generic: "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤", error_api_keys: "ì„œë²„ êµ¬ì„±ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤." }
            },
            'zh': {
                paymentGateway: 'Stripe', lang: 'zh-CN', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 ç­¹ç  - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 ç­¹ç  - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 ç­¹ç  - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° è™šæ‹Ÿè€è™æœº ğŸ°", title: "è™šæ‹Ÿè€è™æœº", welcome: "æ¬¢è¿ï¼", clickToStart: "ç‚¹å‡»ä»»æ„ä½ç½®å¼€å§‹", subtitle: "å¦‚æœ3ä¸ªç¬¦å·å…¨éƒ¨åŒ¹é…ï¼Œå³å¯èµ¢å¾—<strong>20,000 DOLLARS</strong>ï¼", balance: "ä½™é¢", chips: "ç­¹ç ", spin: "æ—‹è½¬", buyChips: "è´­ä¹°ç­¹ç ", goodLuck: "ç¥æ‚¨å¥½è¿ï¼", insufficientChips: "ç­¹ç ä¸è¶³ï¼", spinning: "æ—‹è½¬ä¸­...", tryAgain: "å†è¯•ä¸€æ¬¡ï¼", youWon: "æ‚¨èµ¢å¾—äº†{amount}ä¸ªç­¹ç ï¼", buyChipsTitle: "è´­ä¹°ç­¹ç¢¼", almostThere: "å³å°†å®Œæˆï¼", emailInfo: "è¯·åœ¨ä¸‹æ–¹è¾“å…¥æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€ã€‚å¦‚æœæ‚¨ä¸­å¥–ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ­¤ç”µå­é‚®ä»¶ä¸æ‚¨è”ç³»ï¼š", payWithCard: "ç”¨å¡æ”¯ä»˜", cardInfo: "è¯·åœ¨ä¸‹æ–¹è¾“å…¥æ‚¨çš„å¡ä¿¡æ¯ã€‚", pay: "æ”¯ä»˜ {amount}", processing: "å¤„ç†ä¸­...", paymentSuccessful: "æ”¯ä»˜æˆåŠŸï¼", enterValidEmail: "è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶ã€‚", error_generic: "å‘ç”Ÿé”™è¯¯", error_api_keys: "è¯·æ£€æŸ¥æœåŠ¡å™¨é…ç½®ã€‚" }
            },
            'hi': {
                paymentGateway: 'Stripe', lang: 'hi-IN', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 à¤šà¤¿à¤ªà¥à¤¸ - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 à¤šà¤¿à¤ªà¥à¤¸ - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 à¤šà¤¿à¤ªà¥à¤¸ - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° à¤µà¤°à¥à¤šà¥à¤…à¤² à¤¸à¥à¤²à¥‰à¤Ÿ à¤®à¤¶à¥€à¤¨ ğŸ°", title: "à¤µà¤°à¥à¤šà¥à¤…à¤² à¤¸à¥à¤²à¥‰à¤Ÿ à¤®à¤¶à¥€à¤¨", welcome: "à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ!", clickToStart: "à¤¶à¥à¤°à¥‚ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¤¹à¥€à¤‚ à¤­à¥€ à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚", subtitle: "à¤¯à¤¦à¤¿ à¤¸à¤­à¥€ 3 à¤ªà¥à¤°à¤¤à¥€à¤• à¤®à¥‡à¤² à¤–à¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤¤à¥‹ <strong>20,000 DOLLARS</strong> à¤œà¥€à¤¤à¥‡à¤‚!!!", balance: "à¤¶à¥‡à¤·", chips: "à¤šà¤¿à¤ªà¥à¤¸", spin: "à¤¸à¥à¤ªà¤¿à¤¨", buyChips: "à¤šà¤¿à¤ªà¥à¤¸ à¤–à¤°à¥€à¤¦à¥‡à¤‚", goodLuck: "à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤à¤‚!", insufficientChips: "à¤ªà¤°à¥à¤¯à¤¾à¤ªà¥à¤¤ à¤šà¤¿à¤ªà¥à¤¸ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¤‚!", spinning: "à¤˜à¥‚à¤® à¤°à¤¹à¤¾ à¤¹à¥ˆ...", tryAgain: "à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚!", youWon: "à¤†à¤ªà¤¨à¥‡ {amount} à¤šà¤¿à¤ªà¥à¤¸ à¤œà¥€à¤¤à¥‡!", buyChipsTitle: "à¤šà¤¿à¤ªà¥à¤¸ à¤–à¤°à¥€à¤¦à¥‡à¤‚", almostThere: "à¤²à¤—à¤­à¤— à¤¹à¥‹ à¤—à¤¯à¤¾!", emailInfo: "à¤¨à¥€à¤šà¥‡ à¤…à¤ªà¤¨à¤¾ à¤ˆà¤®à¥‡à¤² à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚à¥¤ à¤¯à¤¦à¤¿ à¤†à¤ª à¤œà¥€à¤¤à¤¤à¥‡ à¤¹à¥ˆà¤‚, à¤¤à¥‹ à¤¹à¤® à¤†à¤ªà¤•à¥‡ à¤ˆà¤®à¥‡à¤² à¤•à¥‡ à¤®à¤¾à¤§à¥à¤¯à¤® à¤¸à¥‡ à¤†à¤ªà¤¸à¥‡ à¤¸à¤‚à¤ªà¤°à¥à¤• à¤•à¤°à¥‡à¤‚à¤—à¥‡:", payWithCard: "à¤•à¤¾à¤°à¥à¤¡ à¤¸à¥‡ à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤•à¤°à¥‡à¤‚", cardInfo: "à¤¨à¥€à¤šà¥‡ à¤…à¤ªà¤¨à¥‡ à¤•à¤¾à¤°à¥à¤¡ à¤•à¤¾ à¤µà¤¿à¤µà¤°à¤£ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚à¥¤", pay: "{amount} à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤•à¤°à¥‡à¤‚", processing: "à¤¸à¤‚à¤¸à¤¾à¤§à¤¿à¤¤ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...", paymentSuccessful: "à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤¸à¤«à¤²!", enterValidEmail: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤à¤• à¤µà¥ˆà¤§ à¤ˆà¤®à¥‡à¤² à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚à¥¤", error_generic: "à¤à¤• à¤¤à¥à¤°à¥à¤Ÿà¤¿ à¤¹à¥à¤ˆ", error_api_keys: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¸à¤°à¥à¤µà¤° à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤—à¤°à¥‡à¤¶à¤¨ à¤•à¥€ à¤œà¤¾à¤à¤š à¤•à¤°à¥‡à¤‚à¥¤" }
            },
            'fil': {
                paymentGateway: 'Stripe', lang: 'fil-PH', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Chips - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Chips - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Chips - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Virtual Slot Machine ğŸ°", title: "Virtual Slot Machine", welcome: "Maligayang pagdating!", clickToStart: "Mag-click kahit saan para magsimula", subtitle: "Manalo ng <strong>20,000 DOLLARS</strong> kung tumugma ang lahat ng 3 simbolo!!!", balance: "BALANSE", chips: "CHIPS", spin: "PAIKUTIN", buyChips: "Bumili ng Chips", goodLuck: "Good Luck!", insufficientChips: "Hindi sapat ang chips!", spinning: "Umiikot...", tryAgain: "Subukang muli!", youWon: "Nanalo ka ng {amount} chips!", buyChipsTitle: "Bumili ng Chips", almostThere: "Malapit na!", emailInfo: "Ilagay ang iyong email sa ibaba. Kung ikaw ay manalo, makikipag-ugnayan kami sa iyo sa pamamagitan ng iyong email:", payWithCard: "Magbayad gamit ang Card", cardInfo: "Ilagay ang mga detalye ng iyong card sa ibaba.", pay: "Magbayad ng {amount}", processing: "Pinoproseso...", paymentSuccessful: "Matagumpay ang pagbabayad!", enterValidEmail: "Mangyaring maglagay ng wastong email.", error_generic: "May naganap na error", error_api_keys: "Pakisuri ang configuration ng server." }
            },
            'sv': {
                paymentGateway: 'Stripe', lang: 'sv-SE', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Marker - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Marker - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Marker - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Virtuell Spelautomat ğŸ°", title: "Virtuell Spelautomat", welcome: "VÃ¤lkommen!", clickToStart: "Klicka var som helst fÃ¶r att bÃ¶rja", subtitle: "Vinn <strong>20.000 DOLLAR</strong> om du matchar alla 3 symboler!!!", balance: "SALDO", chips: "MARKER", spin: "SNURRA", buyChips: "KÃ¶p Marker", goodLuck: "Lycka till!", insufficientChips: "Inte tillrÃ¤ckligt med marker!", spinning: "Snurrar...", tryAgain: "FÃ¶rsÃ¶k igen!", youWon: "Du vann {amount} marker!", buyChipsTitle: "KÃ¶p Marker", almostThere: "NÃ¤stan dÃ¤r!", emailInfo: "Ange din e-postadress nedan. Om du vinner kommer vi att kontakta dig via din e-postadress:", payWithCard: "Betala med kort", cardInfo: "Ange dina kortuppgifter nedan.", pay: "Betala {amount}", processing: "Bearbetar...", paymentSuccessful: "Betalning lyckades!", enterValidEmail: "VÃ¤nligen ange en giltig e-postadress.", error_generic: "Ett fel intrÃ¤ffade", error_api_keys: "Kontrollera serverkonfigurationen." }
            },
            'pl': {
                paymentGateway: 'Stripe', lang: 'pl-PL', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Å»etonÃ³w - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Å»etonÃ³w - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Å»etonÃ³w - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Wirtualny Automat do Gier ğŸ°", title: "Wirtualny Automat do Gier", welcome: "Witaj!", clickToStart: "Kliknij w dowolnym miejscu, aby rozpoczÄ…Ä‡", subtitle: "Wygraj <strong>20.000 DOLARÃ“W</strong>, jeÅ›li trafisz wszystkie 3 symbole!!!", balance: "SALDO", chips: "Å»ETONY", spin: "OBRÃ“Ä†", buyChips: "Kup Å»etony", goodLuck: "Powodzenia!", insufficientChips: "Za maÅ‚o Å¼etonÃ³w!", spinning: "KrÄ™ci siÄ™...", tryAgain: "SprÃ³buj ponownie!", youWon: "WygraÅ‚eÅ› {amount} Å¼etonÃ³w!", buyChipsTitle: "Kup Å»etony", almostThere: "Prawie gotowe!", emailInfo: "Wpisz poniÅ¼ej swÃ³j adres e-mail. JeÅ›li wygrasz, skontaktujemy siÄ™ z TobÄ… za poÅ›rednictwem podanego adresu e-mail:", payWithCard: "ZapÅ‚aÄ‡ kartÄ…", cardInfo: "WprowadÅº dane swojej karty poniÅ¼ej.", pay: "ZapÅ‚aÄ‡ {amount}", processing: "Przetwarzanie...", paymentSuccessful: "PÅ‚atnoÅ›Ä‡ udana!", enterValidEmail: "ProszÄ™ podaÄ‡ prawidÅ‚owy adres e-mail.", error_generic: "WystÄ…piÅ‚ bÅ‚Ä…d", error_api_keys: "SprawdÅº konfiguracjÄ™ serwera." }
            },
            'bn': {
                paymentGateway: 'Stripe', lang: 'bn-BD', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: 'à§§à§¦ à¦šà¦¿à¦ªà¦¸ - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: 'à§¨à§« à¦šà¦¿à¦ªà¦¸ - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: 'à§§à§¦à§¦ à¦šà¦¿à¦ªà¦¸ - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° à¦­à¦¾à¦°à§à¦šà§à¦¯à¦¼à¦¾à¦² à¦¸à§à¦²à¦Ÿ à¦®à§‡à¦¶à¦¿à¦¨ ğŸ°", title: "à¦­à¦¾à¦°à§à¦šà§à¦¯à¦¼à¦¾à¦² à¦¸à§à¦²à¦Ÿ à¦®à§‡à¦¶à¦¿à¦¨", welcome: "à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®!", clickToStart: "à¦¶à§à¦°à§ à¦•à¦°à¦¤à§‡ à¦¯à§‡à¦•à§‹à¦¨à§‹ à¦œà¦¾à¦¯à¦¼à¦—à¦¾à¦¯à¦¼ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨", subtitle: "à¦¯à¦¦à¦¿ à§©à¦Ÿà¦¿ à¦ªà§à¦°à¦¤à§€à¦•à¦‡ à¦®à¦¿à¦²à§‡ à¦¯à¦¾à¦¯à¦¼ à¦¤à¦¬à§‡ <strong>à¥¨à¥¦,à§¦à§¦à§¦ DOLLARS</strong> à¦œà¦¿à¦¤à§à¦¨!!!", balance: "à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸", chips: "à¦šà¦¿à¦ªà¦¸", spin: "à¦¸à§à¦ªà¦¿à¦¨", buyChips: "à¦šà¦¿à¦ªà¦¸ à¦•à¦¿à¦¨à§à¦¨", goodLuck: "à¦¶à§à¦­à¦•à¦¾à¦®à¦¨à¦¾!", insufficientChips: "à¦ªà¦°à§à¦¯à¦¾à¦ªà§à¦¤ à¦šà¦¿à¦ªà¦¸ à¦¨à§‡à¦‡!", spinning: "à¦˜à§à¦°à¦›à§‡...", tryAgain: "à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨!", youWon: "à¦†à¦ªà¦¨à¦¿ {amount} à¦šà¦¿à¦ªà¦¸ à¦œà¦¿à¦¤à§‡à¦›à§‡à¦¨!", buyChipsTitle: "à¦šà¦¿à¦ªà¦¸ à¦•à¦¿à¦¨à§à¦¨", almostThere: "à¦ªà§à¦°à¦¾à¦¯à¦¼ à¦¹à¦¯à¦¼à§‡ à¦—à§‡à¦›à§‡!", emailInfo: "à¦¨à¦¿à¦šà§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦®à§‡à¦² à¦²à¦¿à¦–à§à¦¨à¥¤ à¦†à¦ªà¦¨à¦¿ à¦œà¦¿à¦¤à¦²à§‡, à¦†à¦®à¦°à¦¾ à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦®à§‡à¦²à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à¦¬:", payWithCard: "à¦•à¦¾à¦°à§à¦¡ à¦¦à¦¿à¦¯à¦¼à§‡ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦•à¦°à§à¦¨", cardInfo: "à¦¨à¦¿à¦šà§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦•à¦¾à¦°à§à¦¡à§‡à¦° à¦¬à¦¿à¦¬à¦°à¦£ à¦²à¦¿à¦–à§à¦¨à¥¤", pay: "{amount} à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦•à¦°à§à¦¨", processing: "à¦ªà§à¦°à¦¸à§‡à¦¸à¦¿à¦‚...", paymentSuccessful: "à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¸à¦«à¦² à¦¹à¦¯à¦¼à§‡à¦›à§‡!", enterValidEmail: "à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦¬à§ˆà¦§ à¦‡à¦®à§‡à¦² à¦²à¦¿à¦–à§à¦¨à¥¤", error_generic: "à¦à¦•à¦Ÿà¦¿ à¦¤à§à¦°à§à¦Ÿà¦¿ à¦˜à¦Ÿà§‡à¦›à§‡", error_api_keys: "à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦¸à¦¾à¦°à§à¦­à¦¾à¦° à¦•à¦¨à¦«à¦¿à¦—à¦¾à¦°à§‡à¦¶à¦¨ à¦šà§‡à¦• à¦•à¦°à§à¦¨à¥¤" }
            },
            'ar': {
                paymentGateway: 'Stripe', lang: 'ar-SA', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 Ø±Ù‚Ø§Ø¦Ù‚ - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 Ø±Ù‚Ø§Ù‚Ø© - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 Ø±Ù‚Ø§Ù‚Ø© - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù‚Ù…Ø§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ğŸ°", title: "Ù…Ø§ÙƒÙŠÙ†Ø© Ø§Ù„Ù‚Ù…Ø§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©", welcome: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ!", clickToStart: "Ø§Ù†Ù‚Ø± ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ù„Ù„Ø¨Ø¯Ø¡", subtitle: "Ø§Ø±Ø¨Ø­ <strong>20.000 DOLLARS</strong> Ø¥Ø°Ø§ Ø·Ø§Ø¨Ù‚Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø«Ù„Ø§Ø«Ø©!!!", balance: "Ø§Ù„Ø±ØµÙŠØ¯", chips: "Ø±Ù‚Ø§Ø¦Ù‚", spin: "ØªØ¯ÙˆÙŠØ±", buyChips: "Ø´Ø±Ø§Ø¡ Ø±Ù‚Ø§Ø¦Ù‚", goodLuck: "Ø­Ø¸Ø§Ù‹ Ù…ÙˆÙÙ‚Ø§Ù‹!", insufficientChips: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ù‚Ø§Ø¦Ù‚ ÙƒØ§ÙÙŠØ©!", spinning: "Ø¬Ø§Ø±Ù Ø§Ù„ØªØ¯ÙˆÙŠØ±...", tryAgain: "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!", youWon: "Ù„Ù‚Ø¯ ÙØ²Øª Ø¨Ù€ {amount} Ù…Ù† Ø§Ù„Ø±Ù‚Ø§Ø¦Ù‚!", buyChipsTitle: "Ø´Ø±Ø§Ø¡ Ø±Ù‚Ø§Ø¦Ù‚", almostThere: "Ø£ÙˆØ´ÙƒØª Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡!", emailInfo: "Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ø¯Ù†Ø§Ù‡. Ø¥Ø°Ø§ ÙØ²ØªØŒ Ø³Ù†ØªØµÙ„ Ø¨Ùƒ Ø¹Ø¨Ø± Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:", payWithCard: "Ø§Ù„Ø¯ÙØ¹ Ø¨Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©", cardInfo: "Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø¨Ø·Ø§Ù‚ØªÙƒ Ø£Ø¯Ù†Ø§Ù‡.", pay: "Ø§Ø¯ÙØ¹ {amount}", processing: "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...", paymentSuccessful: "ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!", enterValidEmail: "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ§Ù„Ø­.", error_generic: "Ø­Ø¯Ø« Ø®Ø·Ø£", error_api_keys: "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø®Ø§Ø¯Ù…." }
            },
            'he': {
                paymentGateway: 'Stripe', lang: 'he-IL', currency: '$',
                packages: [
                    { id: 'pack_10_usd', chips: 10, price: 3.00, display: '10 ×¦\'×™×¤×™× - $3.00' },
                    { id: 'pack_25_usd', chips: 25, price: 5.00, display: '25 ×¦\'×™×¤×™× - $5.00' },
                    { id: 'pack_100_usd', chips: 100, price: 10.00, display: '100 ×¦\'×™×¤×™× - $10.00' },
                ],
                translations: { mainTitle: "ğŸ° ××›×•× ×ª ××–×œ ×•×™×¨×˜×•××œ×™×ª ğŸ°", title: "××›×•× ×ª ××–×œ ×•×™×¨×˜×•××œ×™×ª", welcome: "×‘×¨×•×š ×”×‘×!", clickToStart: "×œ×—×¥ ×‘×›×œ ××§×•× ×›×“×™ ×œ×”×ª×—×™×œ", subtitle: "×–×›×” ×‘-<strong>20,000 DOLLARS</strong> ×× ×ª×ª××™× ××ª ×›×œ 3 ×”×¡××œ×™×!!!", balance: "×™×ª×¨×”", chips: "×¦'×™×¤×™×", spin: "×¡×•×‘×‘", buyChips: "×§× ×” ×¦'×™×¤×™×", goodLuck: "×‘×”×¦×œ×—×”!", insufficientChips: "××™×Ÿ ××¡×¤×™×§ ×¦'×™×¤×™×!", spinning: "××¡×ª×•×‘×‘...", tryAgain: "× ×¡×” ×©×•×‘!", youWon: "×–×›×™×ª ×‘-{amount} ×¦'×™×¤×™×!", buyChipsTitle: "×§× ×” ×¦'×™×¤×™×", almostThere: "×›××¢×˜ ×©×!", emailInfo: "×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”×“×•×\"×œ ×©×œ×š ×œ××˜×”. ×× ×ª×–×›×”, × ×™×¦×•×¨ ××™×ª×š ×§×©×¨ ×‘×××¦×¢×•×ª ×›×ª×•×‘×ª ×”×“×•×\"×œ ×©×œ×š:", payWithCard: "×©×œ× ×‘×›×¨×˜×™×¡", cardInfo: "×”×–×Ÿ ××ª ×¤×¨×˜×™ ×”×›×¨×˜×™×¡ ×©×œ×š ×œ××˜×”.", pay: "×©×œ× {amount}", processing: "××¢×‘×“...", paymentSuccessful: "×”×ª×©×œ×•× ×”×•×©×œ× ×‘×”×¦×œ×—×”!", enterValidEmail: "×× × ×”×–×Ÿ ×“×•×\"×œ ×—×•×§×™.", error_generic: "××™×¨×¢×” ×©×’×™××”", error_api_keys: "×× × ×‘×“×•×§ ××ª ×ª×¦×•×¨×ª ×”×©×¨×ª." }
            }
        };

        function t(key, replacements = {}) {
            let text = localeConfig.translations[key] || key;
            for (const [placeholder, value] of Object.entries(replacements)) {
                text = text.replace(`{${placeholder}}`, value);
            }
            return text;
        }

        function applyTranslations() {
            document.querySelectorAll('[data-i18n-key]').forEach(el => {
                const key = el.getAttribute('data-i18n-key');
                el.innerHTML = t(key);
            });
            document.documentElement.lang = localeConfig.lang;
        }

        // --------------- LÃ“GICA DE INICIALIZAÃ‡ÃƒO ---------------
        window.onload = async () => {
            const userFullLang = (navigator.language || navigator.userLanguage).toLowerCase(); 
            const userShortLang = userFullLang.substring(0, 2); 
            localeConfig = locales[userFullLang] || locales[userShortLang] || locales['en'];
            
            applyTranslations();

            try {
                const response = await fetch('/api/session');
                const data = await response.json();
                if (!response.ok) throw new Error("Network response was not ok");
                updateBalance(data.chipBalance);
            } catch (error) {
                console.error("Error loading balance:", error);
                chipBalanceSpan.innerHTML = `Error. <button onclick="window.location.reload()" style="font-size: 0.7em; margin-left: 5px;">Reload</button>`;
            }

            const buyChipsBtn = document.getElementById('buy-chips-btn');
            buyChipsBtn.classList.add('pulsating-button');
            setTimeout(() => {
                buyChipsBtn.classList.remove('pulsating-button');
            }, 10000);
        };

        const startOverlay = document.getElementById('start-overlay');
        startOverlay.addEventListener('click', () => {
            startOverlay.style.display = 'none';
            if (!isMusicPlaying) {
                backgroundMusic.volume = 0.3;
                backgroundMusic.play().catch(e => console.error("Background music blocked by browser."));
                isMusicPlaying = true;
            }
        });
        
        document.addEventListener('visibilitychange', () => {
            if (!isMusicPlaying) return; 
            if (document.visibilityState === 'hidden') {
                backgroundMusic.pause();
            } else {
                backgroundMusic.play().catch(() => {});
            }
        });

        function updateBalance(newBalance) {
            chipBalanceSpan.textContent = newBalance;
        }

        // --------------- LÃ“GICA DO JOGO (SPIN) ---------------
        spinBtn.addEventListener('click', async () => {
            const betAmount = 1;
            const currentBalance = parseInt(chipBalanceSpan.textContent, 10);
            if (isNaN(currentBalance) || currentBalance < betAmount) {
                resultText.textContent = t('insufficientChips');
                resultText.style.color = 'red';
                
                const buyChipsBtn = document.getElementById('buy-chips-btn');
                buyChipsBtn.classList.remove('pulsating-button');
                void buyChipsBtn.offsetWidth; 
                buyChipsBtn.classList.add('pulsating-button');

                setTimeout(() => {
                    buyChipsBtn.classList.remove('pulsating-button');
                }, 10000);

                return;
            }
            spinBtn.disabled = true;
            resultText.textContent = t('spinning');
            resultText.style.color = 'var(--light-text)';
            spinSound.play();
            try {
                const response = await fetch('/api/spin', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ betAmount }), });
                const data = await response.json();
                if (!response.ok) throw new Error(data.error);
                const animationPromises = reels.map((reel, index) => {
                    const duration = 4000 + (index * 500);
                    return animateReel(reel, data.symbols[index], duration);
                });
                await Promise.all(animationPromises);
                if (data.winnings > 0) {
                    resultText.textContent = t('youWon', { amount: data.winnings });
                    resultText.style.color = 'var(--secondary-color)';
                    winSound.play();
                } else {
                    resultText.textContent = t('tryAgain');
                    resultText.style.color = 'var(--light-text)';
                }
                updateBalance(data.newBalance);
            } catch (error) {
                resultText.textContent = error.message;
                resultText.style.color = 'red';
            } finally {
                spinBtn.disabled = false;
            }
        });

        function animateReel(reel, finalSymbol, duration) {
            return new Promise(resolve => {
                const rs = reel.querySelector('.reel-symbols');
                const spinCount = 50;
                rs.style.transition = 'none';
                rs.style.top = '0';
                void rs.offsetHeight;
                let symbolHtml = Array.from({ length: spinCount - 1 }, () => `<span>${symbols[Math.floor(Math.random() * symbols.length)]}</span>`).join('');
                symbolHtml += `<span>${finalSymbol}</span>`;
                rs.innerHTML = symbolHtml;
                const finalPosition = (spinCount - 1) * 100;
                const durationInS = duration / 1000;
                rs.style.transition = `top ${durationInS}s cubic-bezier(0.25, 1, 0.5, 1)`;
                rs.style.top = `-${finalPosition}px`;
                rs.addEventListener('transitionend', resolve, { once: true });
            });
        }
        
        // --------------- LÃ“GICA DE COMPRA DE FICHAS ---------------
        document.getElementById('buy-chips-btn').onclick = () => {
            buyChipsSound.play();
            const modal = document.getElementById('buy-chips-modal');
            modal.style.display = 'flex';

            if (localeConfig.paymentGateway === 'MercadoPago') {
                if (!modal.innerHTML.trim() || !document.getElementById('pix-payment-view')) {
                    let packageHtml = localeConfig.packages.map(pkg => 
                        `<div class="chip-option" onclick="selectChipPackage('${pkg.id}', ${pkg.price})">
                            <strong>${pkg.display}</strong>
                        </div>`
                    ).join('');

                    modal.innerHTML = `
                        <div class="modal-content">
                            <span class="close-button" onclick="closeBuyChipsModal()">&times;</span>
                            <div id="chip-options-view">
                                <h2>${t('buyChipsTitle')}</h2>
                                <div class="chip-options">${packageHtml}</div>
                            </div>
                            <div id="email-prompt-view" style="display: none;">
                                <h2>${t('almostThere')}</h2>
                                <p>${t('emailInfo')}</p>
                                <input type="email" id="email-input" placeholder="seuemail@exemplo.com">
                                <button id="generate-pix-btn" onclick="generatePix()"><strong>${t('buyChips')}</strong></button>
                            </div>
                            <div id="pix-payment-view" style="display: none;">
                                <h2>${t('payWithPix')}</h2>
                                <p>${t('scanQrCode')}</p>
                                <img id="qr-code-image" src="">
                                <p>${t('orUseCopyPaste')}</p>
                                <div id="pix-code-group" style="display:flex;margin:10px 0;">
                                    <input type="text" id="pix-code-input" readonly style="flex-grow:1;padding:10px;border:1px solid #777;background-color:#444;color:white;border-radius:5px 0 0 5px;">
                                    <button id="copy-pix-btn" onclick="copyPixCode()" style="padding:10px 15px;background-color:var(--primary-color);color:white;border:none;border-radius:0 5px 5px 0;cursor:pointer;font-weight:bold;">${t('copy')}</button>
                                </div>
                                <p id="payment-status">${t('waitingPayment')}</p>
                            </div>
                        </div>`;
                }
                document.getElementById('chip-options-view').style.display = 'block';
                document.getElementById('email-prompt-view').style.display = 'none';
                document.getElementById('pix-payment-view').style.display = 'none';
            } else {
                let packageHtml = localeConfig.packages.map(pkg => 
                    `<div class="chip-option" onclick="selectChipPackage('${pkg.id}', ${pkg.price})">
                        <strong>${pkg.display}</strong>
                    </div>`
                ).join('');
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="close-button" onclick="closeBuyChipsModal()">&times;</span>
                        <h2>${t('buyChipsTitle')}</h2>
                        <div class="chip-options">${packageHtml}</div>
                    </div>`;
            }
        };
        
        function closeBuyChipsModal() {
            document.getElementById('buy-chips-modal').style.display = 'none';
            if (paymentCheckInterval) clearInterval(paymentCheckInterval);
        }

        function selectChipPackage(packageId, amount) {
            selectedPackageId = packageId;
            selectedAmount = amount;

            if (localeConfig.paymentGateway === 'MercadoPago') {
                document.getElementById('chip-options-view').style.display = 'none';
                document.getElementById('email-prompt-view').style.display = 'block';
            } else {
                const modalContent = document.querySelector('#buy-chips-modal .modal-content');
                modalContent.innerHTML = `
                    <div class="modal-content">
                        <span class="close-button" onclick="closeBuyChipsModal()">&times;</span>
                        <h2>${t('almostThere')}</h2>
                        <p>${t('emailInfo')}</p>
                        <input type="email" id="email-input" placeholder="youremail@example.com">
                        <button class="submit-btn" onclick="initiateStripePayment()"><strong>${t('buyChips')}</strong></button>
                    </div>`;
            }
        }

        // --- LÃ“GICA DO PIX (MERCADO PAGO) ---
        async function generatePix() {
            const emailInput = document.getElementById('email-input');
            const email = emailInput.value;
            if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
                alert(t('enterValidEmail'));
                return;
            }
            
            document.getElementById('email-prompt-view').style.display = 'none';
            document.getElementById('pix-payment-view').style.display = 'block';
            
            const paymentStatusEl = document.getElementById('payment-status');
            paymentStatusEl.textContent = t('generatingPix');
            paymentStatusEl.classList.remove('blinking-text');


            try {
                const response = await fetch('/api/create-payment', { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        packageId: selectedPackageId, 
                        email: email 
                    }) 
                });
                const data = await response.json();
                if (!response.ok) throw new Error(data.error);

                document.getElementById('qr-code-image').src = `data:image/png;base64,${data.qrCodeBase64}`;
                document.getElementById('pix-code-input').value = data.qrCode;
                
                paymentStatusEl.textContent = t('waitingPayment');
                paymentStatusEl.classList.add('blinking-text');

                currentPaymentId = data.paymentId;
                startPaymentCheck(currentPaymentId);
            } catch(error) {
                paymentStatusEl.textContent = `Erro: ${error.message}`;
                paymentStatusEl.classList.remove('blinking-text');
            }
        }
        
        function copyPixCode() {
            const input = document.getElementById('pix-code-input');
            const button = document.getElementById('copy-pix-btn');
            input.select();
            navigator.clipboard.writeText(input.value);
            button.textContent = t('copied');
            setTimeout(() => { button.textContent = t('copy'); }, 2000);
        }

        function startPaymentCheck(paymentId) {
            if (paymentCheckInterval) clearInterval(paymentCheckInterval);
            paymentCheckInterval = setInterval(async () => {
                try {
                    const response = await fetch(`/api/check-payment?paymentId=${paymentId}`);
                    const data = await response.json();
                    if (data.status === 'approved') {
                        clearInterval(paymentCheckInterval);
                        const paymentStatusEl = document.getElementById('payment-status');
                        paymentStatusEl.textContent = t('paymentApproved');
                        paymentStatusEl.classList.remove('blinking-text');
                        
                        updateBalance(data.newBalance);
                        setTimeout(closeBuyChipsModal, 2000);
                    }
                } catch(error) {
                    console.error("Erro ao verificar pagamento PIX", error);
                    clearInterval(paymentCheckInterval);
                }
            }, 5000);
        }

        // --- LÃ“GICA DO STRIPE ---
        async function initiateStripePayment() {
            const emailInput = document.getElementById('email-input');
            const email = emailInput.value;
            if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
                alert(t('enterValidEmail'));
                return;
            }
            
            const modalContent = document.querySelector('#buy-chips-modal .modal-content');
            modalContent.innerHTML = `<h2>Loading...</h2>`; 

            try {
                const response = await fetch('/api/create-stripe-payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ packageId: selectedPackageId, email })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ error: 'Failed to initiate payment.' }));
                    throw new Error(errorData.error);
                }

                const { clientSecret, error } = await response.json();

                if (error || !clientSecret) {
                    throw new Error(error || 'Could not retrieve payment information.');
                }
                
                const selectedPackage = localeConfig.packages.find(p => p.id === selectedPackageId);
                const payAmount = `${localeConfig.currency}${selectedPackage.price.toFixed(2)}`;

                modalContent.innerHTML = `
                    <div class="modal-content">
                        <span class="close-button" onclick="closeBuyChipsModal()">&times;</span>
                        <h2>${t('payWithCard')}</h2>
                        <p>${t('cardInfo')}</p>
                        <form id="stripe-payment-form">
                            <div id="payment-element"></div>
                            <button id="stripe-submit-btn" class="submit-btn">${t('pay', {amount: payAmount})}</button>
                            <div id="payment-message" style="margin-top:10px; color:red;"></div>
                        </form>
                    </div>`;

                const elements = stripe.elements({ clientSecret });
                const paymentElement = elements.create('payment', {
                  fields: {
                    billingDetails: {
                      address: {
                        country: 'never'
                      }
                    }
                  }
                });
                paymentElement.mount('#payment-element');

                document.getElementById('stripe-payment-form').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    document.getElementById('stripe-submit-btn').disabled = true;
                    document.getElementById('stripe-submit-btn').textContent = t('processing');

                    const { error: stripeError, paymentIntent } = await stripe.confirmPayment({
                        elements,
                        redirect: 'if_required'
                    });

                    if (stripeError) {
                        document.getElementById('payment-message').textContent = stripeError.message;
                        document.getElementById('stripe-submit-btn').disabled = false;
                        document.getElementById('stripe-submit-btn').textContent = t('pay', {amount: payAmount});
                    } else {
                        const verifyResponse = await fetch('/api/verify-stripe-payment', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ paymentIntentId: paymentIntent.id })
                        });
                        const verifyData = await verifyResponse.json();
                        if(verifyData.success) {
                            modalContent.innerHTML = `<h2>${t('paymentSuccessful')}</h2>`;
                            updateBalance(verifyData.newBalance);
                            setTimeout(closeBuyChipsModal, 2000);
                        } else {
                             document.getElementById('payment-message').textContent = "Verification Failed. Please contact support.";
                        }
                    }
                });
            } catch (err) {
                modalContent.innerHTML = `
                    <div class="modal-content">
                        <span class="close-button" onclick="closeBuyChipsModal()">&times;</span>
                        <h2 style="color:red;">${t('error_generic')}</h2>
                        <p>${err.message}</p>
                        <p>${t('error_api_keys')}</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
